Sub StockMarketAnalyst()Dim LastRow As LongDim j As IntegerDim open_price As DoubleDim sum As LongFor Each Sheet In Worksheets   open_price = Sheet.Cells(2, 3)    Sheet.Cells(1, 9) = "Ticker"    Sheet.Cells(1, 10) = "Yearly Change"    Sheet.Cells(1, 11) = "Percent Change"    Sheet.Cells(1, 12) = "Total Stock Volume"        LastRow = Sheet.Cells(Rows.Count, 1).End(xlUp).Row    j = 2    sum = 0       For i = 2 To LastRow       sum = sum + Sheet.Cells(i, 7).Value       If Sheet.Cells(i, 1).Value <> Sheet.Cells(i + 1, 1) Then                      Sheet.Cells(j, 9).Value = Sheet.Cells(i, 1).Value           Sheet.Cells(j, 10).Value = Sheet.Cells(i, 6).Value - open_price                If Sheet.Cells(j, 10).Value >= 0 Then              Sheet.Cells(j, 10).Interior.ColorIndex = 4         Else              Sheet.Cells(j, 10).Interior.ColorIndex = 3         End If              Sheet.Cells(j, 11).Value = Sheet.Cells(j, 10).Value / open_price        open_price = Sheet.Cells(i + 1, 3)        Sheet.Cells(j, 12).Value = sum        sum = 0              j = j + 1           End IfNext i    Next SheetEnd Sub