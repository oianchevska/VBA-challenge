 Sub StockMarketAnalyst()    Dim LastRow As Long    Dim j As Integer    Dim open_price As Double    Dim sum As Double    For Each Sheet In Worksheets                Sheet.Cells(1, 9) = "Ticker"        Sheet.Cells(1, 10) = "Yearly Change"        Sheet.Cells(1, 11) = "Percent Change"        Sheet.Cells(1, 12) = "Total Stock Volume"            LastRow = Sheet.Cells(Rows.Count, 1).End(xlUp).Row        j = 2        sum = 0        open_price = Sheet.Cells(2, 3)                For i = 2 To LastRow                        sum = sum + Sheet.Cells(i, 7).Value                        If Sheet.Cells(i, 1).Value <> Sheet.Cells(i + 1, 1) Then                '                Find Ticker                Sheet.Cells(j, 9).Value = Sheet.Cells(i, 1).Value                '                Find Yearly Change                Sheet.Cells(j, 10).Value = Sheet.Cells(i, 6).Value - open_price      '                Highlight positive change in green and negative change in red                If Sheet.Cells(j, 10).Value >= 0 Then                    Sheet.Cells(j, 10).Interior.ColorIndex = 4                Else                    Sheet.Cells(j, 10).Interior.ColorIndex = 3                End If                '                Change open price from 0 to 1 to avoid divide on zero                If open_price = 0 Then                    open_price = 1                End If                '                Find and format Percent Change                Sheet.Cells(j, 11).Value = Sheet.Cells(j, 10).Value / open_price                Sheet.Cells(j, 11).NumberFormat = "0.00%"                                open_price = Sheet.Cells(i + 1, 3)                                Sheet.Cells(j, 12).Value = sum                sum = 0                      j = j + 1                End If                Next i     Dim LastRow2 As Long     Dim max As Double     Dim maxIndex As Integer     Dim min As Double     Dim minIndex As Integer     Dim maxTotalVolume As Double     Dim maxIndexVolume As Integer          Sheet.Cells(1, 17).Value = "Value"     Sheet.Cells(1, 16).Value = "Ticker"          LastRow2 = Sheet.Cells(Rows.Count, 11).End(xlUp).Row          max = Sheet.Cells(2, 11).Value     maxIndex = 2          min = Sheet.Cells(2, 11).Value     minIndex = 2          maxTotalVolume = Sheet.Cells(2, 12)     maxIndexVolume = 2               For i = 3 To LastRow2                        If Sheet.Cells(i, 11).Value > max Then                  max = Sheet.Cells(i, 11).Value                  maxIndex = i             End If                           If Sheet.Cells(i, 11).Value < min Then                  min = Sheet.Cells(i, 11).Value                  minIndex = i             End If                          If Sheet.Cells(i, 12).Value > maxTotalVolume Then                  maxTotalVolume = Sheet.Cells(i, 12).Value                  maxIndexVolume = i            End If              Next i    '     Find Greatest % Increase     Sheet.Cells(2, 17).Value = max     Sheet.Cells(2, 17).NumberFormat = "0.00%"     '     Find Greatest % Decrease     Sheet.Cells(3, 17).Value = min     Sheet.Cells(3, 17).NumberFormat = "0.00%"     '     Find Greatest Total Volume     Sheet.Cells(4, 17).Value = maxTotalVolume          Sheet.Cells(2, 16) = Cells(maxIndex, 9).Value     Sheet.Cells(3, 16) = Cells(minIndex, 9).Value     Sheet.Cells(4, 16) = Cells(maxIndexVolume, 9).Value          Sheet.Cells(2, 15).Value = "Greatest % Increase"     Sheet.Cells(3, 15).Value = "Greatest % Decrease"     Sheet.Cells(4, 15).Value = "Greatest Total Volume"     '    Auto-extend columns    Sheet.Range("O2:O4").Columns.AutoFit    Next SheetEnd Sub